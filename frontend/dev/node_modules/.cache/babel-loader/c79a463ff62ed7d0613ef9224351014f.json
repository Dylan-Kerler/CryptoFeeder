{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.candleFields = void 0;\n\nvar _crypto = _interopRequireDefault(require(\"crypto\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash.zipobject\"));\n\nrequire(\"isomorphic-fetch\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar BASE = 'https://api.binance.com';\nvar FUTURES = 'https://fapi.binance.com';\n\nvar defaultGetTime = function defaultGetTime() {\n  return Date.now();\n};\n/**\n * Build query string for uri encoded url based on json object\n */\n\n\nvar makeQueryString = function makeQueryString(q) {\n  return q ? \"?\".concat(Object.keys(q).map(function (k) {\n    return \"\".concat(encodeURIComponent(k), \"=\").concat(encodeURIComponent(q[k]));\n  }).join('&')) : '';\n};\n/**\n * Finalize API response\n */\n\n\nvar sendResult = function sendResult(call) {\n  return call.then(function (res) {\n    // If response is ok, we can safely asume it is valid JSON\n    if (res.ok) {\n      return res.json();\n    } // Errors might come from the API itself or the proxy Binance is using.\n    // For API errors the response will be valid JSON,but for proxy errors\n    // it will be HTML\n\n\n    return res.text().then(function (text) {\n      var error;\n\n      try {\n        var json = JSON.parse(text); // The body was JSON parseable, assume it is an API response error\n\n        error = new Error(json.msg || \"\".concat(res.status, \" \").concat(res.statusText));\n        error.code = json.code;\n      } catch (e) {\n        // The body was not JSON parseable, assume it is proxy error\n        error = new Error(\"\".concat(res.status, \" \").concat(res.statusText, \" \").concat(text));\n        error.response = res;\n        error.responseText = text;\n      }\n\n      throw error;\n    });\n  });\n};\n/**\n * Util to validate existence of required parameter(s)\n */\n\n\nvar checkParams = function checkParams(name, payload) {\n  var requires = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n\n  if (!payload) {\n    throw new Error('You need to pass a payload object.');\n  }\n\n  requires.forEach(function (r) {\n    if (!payload[r] && isNaN(payload[r])) {\n      throw new Error(\"Method \".concat(name, \" requires \").concat(r, \" parameter.\"));\n    }\n  });\n  return true;\n};\n/**\n * Make public calls against the api\n *\n * @param {string} path Endpoint path\n * @param {object} data The payload to be sent\n * @param {string} method HTTB VERB, GET by default\n * @param {object} headers\n * @returns {object} The api response\n */\n\n\nvar publicCall = function publicCall(_ref) {\n  var endpoints = _ref.endpoints;\n  return function (path, data) {\n    var method = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'GET';\n    var headers = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    return sendResult(fetch(\"\".concat(!path.includes('/fapi') ? endpoints.base : endpoints.futures).concat(path).concat(makeQueryString(data)), {\n      method: method,\n      json: true,\n      headers: headers\n    }));\n  };\n};\n/**\n * Factory method for partial private calls against the api\n *\n * @param {string} path Endpoint path\n * @param {object} data The payload to be sent\n * @param {string} method HTTB VERB, GET by default\n * @returns {object} The api response\n */\n\n\nvar keyCall = function keyCall(_ref2) {\n  var apiKey = _ref2.apiKey,\n      pubCall = _ref2.pubCall;\n  return function (path, data) {\n    var method = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'GET';\n\n    if (!apiKey) {\n      throw new Error('You need to pass an API key to make this call.');\n    }\n\n    return pubCall(path, data, method, {\n      'X-MBX-APIKEY': apiKey\n    });\n  };\n};\n/**\n * Factory method for private calls against the api\n *\n * @param {string} path Endpoint path\n * @param {object} data The payload to be sent\n * @param {string} method HTTB VERB, GET by default\n * @param {object} headers\n * @returns {object} The api response\n */\n\n\nvar privateCall = function privateCall(_ref3) {\n  var apiKey = _ref3.apiKey,\n      apiSecret = _ref3.apiSecret,\n      endpoints = _ref3.endpoints,\n      _ref3$getTime = _ref3.getTime,\n      getTime = _ref3$getTime === void 0 ? defaultGetTime : _ref3$getTime,\n      pubCall = _ref3.pubCall;\n  return function (path) {\n    var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var method = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'GET';\n    var noData = arguments.length > 3 ? arguments[3] : undefined;\n    var noExtra = arguments.length > 4 ? arguments[4] : undefined;\n\n    if (!apiKey || !apiSecret) {\n      throw new Error('You need to pass an API key and secret to make authenticated calls.');\n    }\n\n    return (data && data.useServerTime ? pubCall('/api/v1/time').then(function (r) {\n      return r.serverTime;\n    }) : Promise.resolve(getTime())).then(function (timestamp) {\n      if (data) {\n        delete data.useServerTime;\n      }\n\n      var signature = _crypto.default.createHmac('sha256', apiSecret).update(makeQueryString(_objectSpread({}, data, {\n        timestamp: timestamp\n      })).substr(1)).digest('hex');\n\n      var newData = noExtra ? data : _objectSpread({}, data, {\n        timestamp: timestamp,\n        signature: signature\n      });\n      return sendResult(fetch(\"\".concat(!path.includes('/fapi') ? endpoints.base : endpoints.futures).concat(path).concat(noData ? '' : makeQueryString(newData)), {\n        method: method,\n        headers: {\n          'X-MBX-APIKEY': apiKey\n        },\n        json: true\n      }));\n    });\n  };\n};\n\nvar candleFields = ['openTime', 'open', 'high', 'low', 'close', 'volume', 'closeTime', 'quoteVolume', 'trades', 'baseAssetVolume', 'quoteAssetVolume'];\n/**\n * Get candles for a specific pair and interval and convert response\n * to a user friendly collection.\n */\n\nexports.candleFields = candleFields;\n\nvar _candles = function candles(pubCall, payload) {\n  return checkParams('candles', payload, ['symbol']) && pubCall('/api/v1/klines', _objectSpread({\n    interval: '5m'\n  }, payload)).then(function (candles) {\n    return candles.map(function (candle) {\n      return (0, _lodash.default)(candleFields, candle);\n    });\n  });\n};\n/**\n * Create a new order wrapper for market order simplicity\n */\n\n\nvar _order = function order(privCall) {\n  var payload = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var url = arguments.length > 2 ? arguments[2] : undefined;\n  var newPayload = ['LIMIT', 'STOP_LOSS_LIMIT', 'TAKE_PROFIT_LIMIT'].includes(payload.type) || !payload.type ? _objectSpread({\n    timeInForce: 'GTC'\n  }, payload) : payload;\n  return checkParams('order', newPayload, ['symbol', 'side', 'quantity']) && privCall(url, _objectSpread({\n    type: 'LIMIT'\n  }, newPayload), 'POST');\n};\n/**\n * Zip asks and bids reponse from order book\n */\n\n\nvar _book = function book(pubCall, payload) {\n  return checkParams('book', payload, ['symbol']) && pubCall('/api/v1/depth', payload).then(function (_ref4) {\n    var lastUpdateId = _ref4.lastUpdateId,\n        asks = _ref4.asks,\n        bids = _ref4.bids;\n    return {\n      lastUpdateId: lastUpdateId,\n      asks: asks.map(function (a) {\n        return (0, _lodash.default)(['price', 'quantity'], a);\n      }),\n      bids: bids.map(function (b) {\n        return (0, _lodash.default)(['price', 'quantity'], b);\n      })\n    };\n  });\n};\n\nvar _aggTrades = function aggTrades(pubCall, payload) {\n  return checkParams('aggTrades', payload, ['symbol']) && pubCall('/api/v1/aggTrades', payload).then(function (trades) {\n    return trades.map(function (trade) {\n      return {\n        aggId: trade.a,\n        price: trade.p,\n        quantity: trade.q,\n        firstId: trade.f,\n        lastId: trade.l,\n        timestamp: trade.T,\n        isBuyerMaker: trade.m,\n        wasBestPrice: trade.M\n      };\n    });\n  });\n};\n\nvar _default = function _default(opts) {\n  var endpoints = {\n    'base': opts && opts.httpBase || BASE,\n    'futures': opts && opts.httpFutures || FUTURES\n  };\n  var pubCall = publicCall(_objectSpread({}, opts, {\n    endpoints: endpoints\n  }));\n  var privCall = privateCall(_objectSpread({}, opts, {\n    endpoints: endpoints,\n    pubCall: pubCall\n  }));\n  var kCall = keyCall(_objectSpread({}, opts, {\n    pubCall: pubCall\n  }));\n  return {\n    ping: function ping() {\n      return pubCall('/api/v1/ping').then(function () {\n        return true;\n      });\n    },\n    time: function time() {\n      return pubCall('/api/v1/time').then(function (r) {\n        return r.serverTime;\n      });\n    },\n    exchangeInfo: function exchangeInfo() {\n      return pubCall('/api/v1/exchangeInfo');\n    },\n    book: function book(payload) {\n      return _book(pubCall, payload);\n    },\n    aggTrades: function aggTrades(payload) {\n      return _aggTrades(pubCall, payload);\n    },\n    candles: function candles(payload) {\n      return _candles(pubCall, payload);\n    },\n    trades: function trades(payload) {\n      return checkParams('trades', payload, ['symbol']) && pubCall('/api/v1/trades', payload);\n    },\n    tradesHistory: function tradesHistory(payload) {\n      return checkParams('tradesHitory', payload, ['symbol']) && kCall('/api/v1/historicalTrades', payload);\n    },\n    dailyStats: function dailyStats(payload) {\n      return pubCall('/api/v1/ticker/24hr', payload);\n    },\n    prices: function prices() {\n      return pubCall('/api/v1/ticker/allPrices').then(function (r) {\n        return r.reduce(function (out, cur) {\n          return out[cur.symbol] = cur.price, out;\n        }, {});\n      });\n    },\n    avgPrice: function avgPrice(payload) {\n      return pubCall('/api/v3/avgPrice', payload);\n    },\n    allBookTickers: function allBookTickers() {\n      return pubCall('/api/v1/ticker/allBookTickers').then(function (r) {\n        return r.reduce(function (out, cur) {\n          return out[cur.symbol] = cur, out;\n        }, {});\n      });\n    },\n\n    /**\n     * Call unmanaged private call to Binance api; you need a key and secret\n     */\n    privateRequest: function privateRequest(method, url, payload) {\n      return privCall(url, payload, method);\n    },\n\n    /**\n     * Call unmanaged public call to Binance api\n     */\n    publicRequest: function publicRequest(method, url, payload) {\n      return pubCall(url, payload, method);\n    },\n    order: function order(payload) {\n      return _order(privCall, payload, '/api/v3/order');\n    },\n    orderTest: function orderTest(payload) {\n      return _order(privCall, payload, '/api/v3/order/test');\n    },\n    getOrder: function getOrder(payload) {\n      return privCall('/api/v3/order', payload);\n    },\n    cancelOrder: function cancelOrder(payload) {\n      return privCall('/api/v3/order', payload, 'DELETE');\n    },\n    openOrders: function openOrders(payload) {\n      return privCall('/api/v3/openOrders', payload);\n    },\n    allOrders: function allOrders(payload) {\n      return privCall('/api/v3/allOrders', payload);\n    },\n    accountInfo: function accountInfo(payload) {\n      return privCall('/api/v3/account', payload);\n    },\n    myTrades: function myTrades(payload) {\n      return privCall('/api/v3/myTrades', payload);\n    },\n    withdraw: function withdraw(payload) {\n      return privCall('/wapi/v3/withdraw.html', payload, 'POST');\n    },\n    withdrawHistory: function withdrawHistory(payload) {\n      return privCall('/wapi/v3/withdrawHistory.html', payload);\n    },\n    depositHistory: function depositHistory(payload) {\n      return privCall('/wapi/v3/depositHistory.html', payload);\n    },\n    depositAddress: function depositAddress(payload) {\n      return privCall('/wapi/v3/depositAddress.html', payload);\n    },\n    tradeFee: function tradeFee(payload) {\n      return privCall('/wapi/v3/tradeFee.html', payload);\n    },\n    assetDetail: function assetDetail(payload) {\n      return privCall('/wapi/v3/assetDetail.html', payload);\n    },\n    getDataStream: function getDataStream() {\n      return privCall('/api/v1/userDataStream', null, 'POST', true);\n    },\n    keepDataStream: function keepDataStream(payload) {\n      return privCall('/api/v1/userDataStream', payload, 'PUT', false, true);\n    },\n    closeDataStream: function closeDataStream(payload) {\n      return privCall('/api/v1/userDataStream', payload, 'DELETE', false, true);\n    },\n    marginGetDataStream: function marginGetDataStream() {\n      return privCall('/sapi/v1/userDataStream', null, 'POST', true);\n    },\n    marginKeepDataStream: function marginKeepDataStream(payload) {\n      return privCall('/sapi/v1/userDataStream', payload, 'PUT', false, true);\n    },\n    marginCloseDataStream: function marginCloseDataStream(payload) {\n      return privCall('/sapi/v1/userDataStream', payload, 'DELETE', false, true);\n    },\n    futuresGetDataStream: function futuresGetDataStream() {\n      return privCall('/fapi/v1/listenKey', null, 'POST', true);\n    },\n    futuresKeepDataStream: function futuresKeepDataStream(payload) {\n      return privCall('/fapi/v1/listenKey', payload, 'PUT', false, true);\n    },\n    futuresCloseDataStream: function futuresCloseDataStream(payload) {\n      return privCall('/fapi/v1/listenKey', payload, 'DELETE', false, true);\n    },\n    marginAllOrders: function marginAllOrders(payload) {\n      return privCall('/sapi/v1/margin/allOrders', payload);\n    },\n    marginOrder: function marginOrder(payload) {\n      return _order(privCall, payload, '/sapi/v1/margin/order');\n    },\n    marginCancelOrder: function marginCancelOrder(payload) {\n      return privCall('/sapi/v1/margin/order', payload, 'DELETE');\n    },\n    marginOpenOrders: function marginOpenOrders(payload) {\n      return privCall('/sapi/v1/margin/openOrders', payload);\n    },\n    marginAccountInfo: function marginAccountInfo(payload) {\n      return privCall('/sapi/v1/margin/account', payload);\n    },\n    marginMyTrades: function marginMyTrades(payload) {\n      return privCall('/sapi/v1/margin/myTrades', payload);\n    }\n  };\n};\n\nexports.default = _default;","map":{"version":3,"sources":["/home/levi/Desktop/WebProjects/CryptoFeeder/node_modules/binance-api-node/dist/http-client.js"],"names":["Object","defineProperty","exports","value","default","candleFields","_crypto","_interopRequireDefault","require","_lodash","obj","__esModule","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","configurable","writable","BASE","FUTURES","defaultGetTime","Date","now","makeQueryString","q","concat","map","k","encodeURIComponent","join","sendResult","call","then","res","ok","json","text","error","JSON","parse","Error","msg","status","statusText","code","e","response","responseText","checkParams","name","payload","requires","undefined","r","isNaN","publicCall","_ref","endpoints","path","data","method","headers","fetch","includes","base","futures","keyCall","_ref2","apiKey","pubCall","privateCall","_ref3","apiSecret","_ref3$getTime","getTime","noData","noExtra","useServerTime","serverTime","Promise","resolve","timestamp","signature","createHmac","update","substr","digest","newData","_candles","candles","interval","candle","_order","order","privCall","url","newPayload","type","timeInForce","_book","book","_ref4","lastUpdateId","asks","bids","a","b","_aggTrades","aggTrades","trades","trade","aggId","price","p","quantity","firstId","f","lastId","l","T","isBuyerMaker","m","wasBestPrice","M","_default","opts","httpBase","httpFutures","kCall","ping","time","exchangeInfo","tradesHistory","dailyStats","prices","reduce","out","cur","symbol","avgPrice","allBookTickers","privateRequest","publicRequest","orderTest","getOrder","cancelOrder","openOrders","allOrders","accountInfo","myTrades","withdraw","withdrawHistory","depositHistory","depositAddress","tradeFee","assetDetail","getDataStream","keepDataStream","closeDataStream","marginGetDataStream","marginKeepDataStream","marginCloseDataStream","futuresGetDataStream","futuresKeepDataStream","futuresCloseDataStream","marginAllOrders","marginOrder","marginCancelOrder","marginOpenOrders","marginAccountInfo","marginMyTrades"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.candleFields = void 0;\n\nvar _crypto = _interopRequireDefault(require(\"crypto\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash.zipobject\"));\n\nrequire(\"isomorphic-fetch\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar BASE = 'https://api.binance.com';\nvar FUTURES = 'https://fapi.binance.com';\n\nvar defaultGetTime = function defaultGetTime() {\n  return Date.now();\n};\n/**\n * Build query string for uri encoded url based on json object\n */\n\n\nvar makeQueryString = function makeQueryString(q) {\n  return q ? \"?\".concat(Object.keys(q).map(function (k) {\n    return \"\".concat(encodeURIComponent(k), \"=\").concat(encodeURIComponent(q[k]));\n  }).join('&')) : '';\n};\n/**\n * Finalize API response\n */\n\n\nvar sendResult = function sendResult(call) {\n  return call.then(function (res) {\n    // If response is ok, we can safely asume it is valid JSON\n    if (res.ok) {\n      return res.json();\n    } // Errors might come from the API itself or the proxy Binance is using.\n    // For API errors the response will be valid JSON,but for proxy errors\n    // it will be HTML\n\n\n    return res.text().then(function (text) {\n      var error;\n\n      try {\n        var json = JSON.parse(text); // The body was JSON parseable, assume it is an API response error\n\n        error = new Error(json.msg || \"\".concat(res.status, \" \").concat(res.statusText));\n        error.code = json.code;\n      } catch (e) {\n        // The body was not JSON parseable, assume it is proxy error\n        error = new Error(\"\".concat(res.status, \" \").concat(res.statusText, \" \").concat(text));\n        error.response = res;\n        error.responseText = text;\n      }\n\n      throw error;\n    });\n  });\n};\n/**\n * Util to validate existence of required parameter(s)\n */\n\n\nvar checkParams = function checkParams(name, payload) {\n  var requires = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n\n  if (!payload) {\n    throw new Error('You need to pass a payload object.');\n  }\n\n  requires.forEach(function (r) {\n    if (!payload[r] && isNaN(payload[r])) {\n      throw new Error(\"Method \".concat(name, \" requires \").concat(r, \" parameter.\"));\n    }\n  });\n  return true;\n};\n/**\n * Make public calls against the api\n *\n * @param {string} path Endpoint path\n * @param {object} data The payload to be sent\n * @param {string} method HTTB VERB, GET by default\n * @param {object} headers\n * @returns {object} The api response\n */\n\n\nvar publicCall = function publicCall(_ref) {\n  var endpoints = _ref.endpoints;\n  return function (path, data) {\n    var method = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'GET';\n    var headers = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    return sendResult(fetch(\"\".concat(!path.includes('/fapi') ? endpoints.base : endpoints.futures).concat(path).concat(makeQueryString(data)), {\n      method: method,\n      json: true,\n      headers: headers\n    }));\n  };\n};\n/**\n * Factory method for partial private calls against the api\n *\n * @param {string} path Endpoint path\n * @param {object} data The payload to be sent\n * @param {string} method HTTB VERB, GET by default\n * @returns {object} The api response\n */\n\n\nvar keyCall = function keyCall(_ref2) {\n  var apiKey = _ref2.apiKey,\n      pubCall = _ref2.pubCall;\n  return function (path, data) {\n    var method = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'GET';\n\n    if (!apiKey) {\n      throw new Error('You need to pass an API key to make this call.');\n    }\n\n    return pubCall(path, data, method, {\n      'X-MBX-APIKEY': apiKey\n    });\n  };\n};\n/**\n * Factory method for private calls against the api\n *\n * @param {string} path Endpoint path\n * @param {object} data The payload to be sent\n * @param {string} method HTTB VERB, GET by default\n * @param {object} headers\n * @returns {object} The api response\n */\n\n\nvar privateCall = function privateCall(_ref3) {\n  var apiKey = _ref3.apiKey,\n      apiSecret = _ref3.apiSecret,\n      endpoints = _ref3.endpoints,\n      _ref3$getTime = _ref3.getTime,\n      getTime = _ref3$getTime === void 0 ? defaultGetTime : _ref3$getTime,\n      pubCall = _ref3.pubCall;\n  return function (path) {\n    var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var method = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'GET';\n    var noData = arguments.length > 3 ? arguments[3] : undefined;\n    var noExtra = arguments.length > 4 ? arguments[4] : undefined;\n\n    if (!apiKey || !apiSecret) {\n      throw new Error('You need to pass an API key and secret to make authenticated calls.');\n    }\n\n    return (data && data.useServerTime ? pubCall('/api/v1/time').then(function (r) {\n      return r.serverTime;\n    }) : Promise.resolve(getTime())).then(function (timestamp) {\n      if (data) {\n        delete data.useServerTime;\n      }\n\n      var signature = _crypto.default.createHmac('sha256', apiSecret).update(makeQueryString(_objectSpread({}, data, {\n        timestamp: timestamp\n      })).substr(1)).digest('hex');\n\n      var newData = noExtra ? data : _objectSpread({}, data, {\n        timestamp: timestamp,\n        signature: signature\n      });\n      return sendResult(fetch(\"\".concat(!path.includes('/fapi') ? endpoints.base : endpoints.futures).concat(path).concat(noData ? '' : makeQueryString(newData)), {\n        method: method,\n        headers: {\n          'X-MBX-APIKEY': apiKey\n        },\n        json: true\n      }));\n    });\n  };\n};\n\nvar candleFields = ['openTime', 'open', 'high', 'low', 'close', 'volume', 'closeTime', 'quoteVolume', 'trades', 'baseAssetVolume', 'quoteAssetVolume'];\n/**\n * Get candles for a specific pair and interval and convert response\n * to a user friendly collection.\n */\n\nexports.candleFields = candleFields;\n\nvar _candles = function candles(pubCall, payload) {\n  return checkParams('candles', payload, ['symbol']) && pubCall('/api/v1/klines', _objectSpread({\n    interval: '5m'\n  }, payload)).then(function (candles) {\n    return candles.map(function (candle) {\n      return (0, _lodash.default)(candleFields, candle);\n    });\n  });\n};\n/**\n * Create a new order wrapper for market order simplicity\n */\n\n\nvar _order = function order(privCall) {\n  var payload = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var url = arguments.length > 2 ? arguments[2] : undefined;\n  var newPayload = ['LIMIT', 'STOP_LOSS_LIMIT', 'TAKE_PROFIT_LIMIT'].includes(payload.type) || !payload.type ? _objectSpread({\n    timeInForce: 'GTC'\n  }, payload) : payload;\n  return checkParams('order', newPayload, ['symbol', 'side', 'quantity']) && privCall(url, _objectSpread({\n    type: 'LIMIT'\n  }, newPayload), 'POST');\n};\n/**\n * Zip asks and bids reponse from order book\n */\n\n\nvar _book = function book(pubCall, payload) {\n  return checkParams('book', payload, ['symbol']) && pubCall('/api/v1/depth', payload).then(function (_ref4) {\n    var lastUpdateId = _ref4.lastUpdateId,\n        asks = _ref4.asks,\n        bids = _ref4.bids;\n    return {\n      lastUpdateId: lastUpdateId,\n      asks: asks.map(function (a) {\n        return (0, _lodash.default)(['price', 'quantity'], a);\n      }),\n      bids: bids.map(function (b) {\n        return (0, _lodash.default)(['price', 'quantity'], b);\n      })\n    };\n  });\n};\n\nvar _aggTrades = function aggTrades(pubCall, payload) {\n  return checkParams('aggTrades', payload, ['symbol']) && pubCall('/api/v1/aggTrades', payload).then(function (trades) {\n    return trades.map(function (trade) {\n      return {\n        aggId: trade.a,\n        price: trade.p,\n        quantity: trade.q,\n        firstId: trade.f,\n        lastId: trade.l,\n        timestamp: trade.T,\n        isBuyerMaker: trade.m,\n        wasBestPrice: trade.M\n      };\n    });\n  });\n};\n\nvar _default = function _default(opts) {\n  var endpoints = {\n    'base': opts && opts.httpBase || BASE,\n    'futures': opts && opts.httpFutures || FUTURES\n  };\n  var pubCall = publicCall(_objectSpread({}, opts, {\n    endpoints: endpoints\n  }));\n  var privCall = privateCall(_objectSpread({}, opts, {\n    endpoints: endpoints,\n    pubCall: pubCall\n  }));\n  var kCall = keyCall(_objectSpread({}, opts, {\n    pubCall: pubCall\n  }));\n  return {\n    ping: function ping() {\n      return pubCall('/api/v1/ping').then(function () {\n        return true;\n      });\n    },\n    time: function time() {\n      return pubCall('/api/v1/time').then(function (r) {\n        return r.serverTime;\n      });\n    },\n    exchangeInfo: function exchangeInfo() {\n      return pubCall('/api/v1/exchangeInfo');\n    },\n    book: function book(payload) {\n      return _book(pubCall, payload);\n    },\n    aggTrades: function aggTrades(payload) {\n      return _aggTrades(pubCall, payload);\n    },\n    candles: function candles(payload) {\n      return _candles(pubCall, payload);\n    },\n    trades: function trades(payload) {\n      return checkParams('trades', payload, ['symbol']) && pubCall('/api/v1/trades', payload);\n    },\n    tradesHistory: function tradesHistory(payload) {\n      return checkParams('tradesHitory', payload, ['symbol']) && kCall('/api/v1/historicalTrades', payload);\n    },\n    dailyStats: function dailyStats(payload) {\n      return pubCall('/api/v1/ticker/24hr', payload);\n    },\n    prices: function prices() {\n      return pubCall('/api/v1/ticker/allPrices').then(function (r) {\n        return r.reduce(function (out, cur) {\n          return out[cur.symbol] = cur.price, out;\n        }, {});\n      });\n    },\n    avgPrice: function avgPrice(payload) {\n      return pubCall('/api/v3/avgPrice', payload);\n    },\n    allBookTickers: function allBookTickers() {\n      return pubCall('/api/v1/ticker/allBookTickers').then(function (r) {\n        return r.reduce(function (out, cur) {\n          return out[cur.symbol] = cur, out;\n        }, {});\n      });\n    },\n\n    /**\n     * Call unmanaged private call to Binance api; you need a key and secret\n     */\n    privateRequest: function privateRequest(method, url, payload) {\n      return privCall(url, payload, method);\n    },\n\n    /**\n     * Call unmanaged public call to Binance api\n     */\n    publicRequest: function publicRequest(method, url, payload) {\n      return pubCall(url, payload, method);\n    },\n    order: function order(payload) {\n      return _order(privCall, payload, '/api/v3/order');\n    },\n    orderTest: function orderTest(payload) {\n      return _order(privCall, payload, '/api/v3/order/test');\n    },\n    getOrder: function getOrder(payload) {\n      return privCall('/api/v3/order', payload);\n    },\n    cancelOrder: function cancelOrder(payload) {\n      return privCall('/api/v3/order', payload, 'DELETE');\n    },\n    openOrders: function openOrders(payload) {\n      return privCall('/api/v3/openOrders', payload);\n    },\n    allOrders: function allOrders(payload) {\n      return privCall('/api/v3/allOrders', payload);\n    },\n    accountInfo: function accountInfo(payload) {\n      return privCall('/api/v3/account', payload);\n    },\n    myTrades: function myTrades(payload) {\n      return privCall('/api/v3/myTrades', payload);\n    },\n    withdraw: function withdraw(payload) {\n      return privCall('/wapi/v3/withdraw.html', payload, 'POST');\n    },\n    withdrawHistory: function withdrawHistory(payload) {\n      return privCall('/wapi/v3/withdrawHistory.html', payload);\n    },\n    depositHistory: function depositHistory(payload) {\n      return privCall('/wapi/v3/depositHistory.html', payload);\n    },\n    depositAddress: function depositAddress(payload) {\n      return privCall('/wapi/v3/depositAddress.html', payload);\n    },\n    tradeFee: function tradeFee(payload) {\n      return privCall('/wapi/v3/tradeFee.html', payload);\n    },\n    assetDetail: function assetDetail(payload) {\n      return privCall('/wapi/v3/assetDetail.html', payload);\n    },\n    getDataStream: function getDataStream() {\n      return privCall('/api/v1/userDataStream', null, 'POST', true);\n    },\n    keepDataStream: function keepDataStream(payload) {\n      return privCall('/api/v1/userDataStream', payload, 'PUT', false, true);\n    },\n    closeDataStream: function closeDataStream(payload) {\n      return privCall('/api/v1/userDataStream', payload, 'DELETE', false, true);\n    },\n    marginGetDataStream: function marginGetDataStream() {\n      return privCall('/sapi/v1/userDataStream', null, 'POST', true);\n    },\n    marginKeepDataStream: function marginKeepDataStream(payload) {\n      return privCall('/sapi/v1/userDataStream', payload, 'PUT', false, true);\n    },\n    marginCloseDataStream: function marginCloseDataStream(payload) {\n      return privCall('/sapi/v1/userDataStream', payload, 'DELETE', false, true);\n    },\n    futuresGetDataStream: function futuresGetDataStream() {\n      return privCall('/fapi/v1/listenKey', null, 'POST', true);\n    },\n    futuresKeepDataStream: function futuresKeepDataStream(payload) {\n      return privCall('/fapi/v1/listenKey', payload, 'PUT', false, true);\n    },\n    futuresCloseDataStream: function futuresCloseDataStream(payload) {\n      return privCall('/fapi/v1/listenKey', payload, 'DELETE', false, true);\n    },\n    marginAllOrders: function marginAllOrders(payload) {\n      return privCall('/sapi/v1/margin/allOrders', payload);\n    },\n    marginOrder: function marginOrder(payload) {\n      return _order(privCall, payload, '/sapi/v1/margin/order');\n    },\n    marginCancelOrder: function marginCancelOrder(payload) {\n      return privCall('/sapi/v1/margin/order', payload, 'DELETE');\n    },\n    marginOpenOrders: function marginOpenOrders(payload) {\n      return privCall('/sapi/v1/margin/openOrders', payload);\n    },\n    marginAccountInfo: function marginAccountInfo(payload) {\n      return privCall('/sapi/v1/margin/account', payload);\n    },\n    marginMyTrades: function marginMyTrades(payload) {\n      return privCall('/sapi/v1/margin/myTrades', payload);\n    }\n  };\n};\n\nexports.default = _default;"]},"metadata":{},"sourceType":"script"}